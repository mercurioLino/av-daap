version: '3.0'
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
intents:
- rescue
- inform_phone
- inform_animal_type
- inform_animal_attributes
- inform_name
- greet
- give_to_adoption
- donate
- inform_adress
- inform_email
- address
- affirmation
- negation

entities:
- animal_type
- medical_attention
- urgency
- name
- phone
- email
- number
- rua
- bairro
- url

slots:
  address_details:
    type: bool
    influence_conversation: true
    mappings:
    - type: custom
  address_number:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: number
      conditions:     #Adicionado por Biazom -> Para evitar conflito com numero de telefone
      - active_loop: adress_form

  address_street:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: rua
  address_district:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: bairro
  address_landmark:
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
      - active_loop: address_form
        requested_slot: address_landmark
         
  #Slots do Rescue e Donate Animal
  animal_type:
    type: text
    influence_conversation: true
    mappings:
    - type: custom
  animal_attributes:
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
      - active_loop: rescue_form
        requested_slot: animal_attributes
  animal_urgency:
    type: bool
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: urgency
      conditions:
      - active_loop: rescue_form
        requested_slot: animal_urgency
  animal_medical_attention:
    type: bool
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: medical_attention
      conditions:
      - active_loop: rescue_form
        requested_slot: animal_medical_attention

  #Slots do Contact
  name:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: name
  phone:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: phone
  email:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: email


  url:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: url

#Utters (Respostas)
responses:
  utter_address_details:
  - text: Você conhece os detalhes do endereço?

  utter_submit_contact:
  - text: '{name} {phone} {animal_type}'

  utter_submit:
  - text: '{address_details}, {address_number}, {address_street}, {address_district}, {address_landmark}'

  utter_greet:
  - text: |-
      Olá, eu sou o chatbot do DAAP! Minha função é facilitar o fluxo de informações entre nossa comunidade.
      Escolha qual opção melhor se adequa à sua necessidade:
      1. Pedido de Resgate de Animal
      2. Doação de Animal
      3. Fazer uma doação à DAAP
      4. Dúvidas

  utter_ask_address_number:
  - text: Qual o número?

  utter_ask_address_street:
  - text: Qual a rua?

  utter_ask_address_district:
  - text: Qual o bairro?

  utter_ask_address_landmark:
  - text: Qual a referência?

  utter_ask_animal_type:
  - text: 'Qual é o animal? (Exemplo: Cachorro, gato...)'

  utter_ask_animal_attributes:
  - text: Quais são as características do animal?

  utter_ask_medical_attention:
  - text: O animal necessita de algum tipo de cuidado médico?

  utter_ask_animal_urgency:
  - text: Este caso é um caso de urgência?

  utter_ask_name:
  - text: Qual é o nome do responsável pelo animal? (Caso não saiba, informe o nome de um responsável para contato)

  utter_ask_phone:
  - text: 'Qual o telefone do responsável? (Ex.: 18 99777-9977)'

  utter_ask_email:
  - text: 'Informe um e-mail para contato:'

  utter_provide_contact_info:
  - text: Primeiramente, preciso dos dados do responsável pelo animal.

  utter_provide_animal_info:
  - text: Ok, agora preciso dos dados do animal.

  utter_provide_animal_location:
  - text: Ok, agora preciso do endereço aonde o animal está localizado.


actions:
- action_session_start
- action_set_address_details_preference
- utter_ask_animal_attributes
- utter_greet
- utter_provide_animal_info
- utter_provide_contact_info


forms:
  rescue_form:
    required_slots:
    - animal_type
    - animal_attributes
    - animal_medical_attention
    - animal_urgency

  contact_form:
    required_slots:
    - name
    - phone
    - email

  address_form:
    required_slots:
    - address_number
    - address_street
    - address_district
    - address_landmark
